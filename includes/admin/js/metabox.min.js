jQuery(document).ready((function(t){t.fn.crpAutocompletePosts=function(e){var n,a,o=t(this),c=t("#post_ID").val();const i="crp_get_posts_action",l="#crp-post-list",s="#crp-manual-related-csv",d=1,p=(e=e||{}).ajaxAction||o.attr("data-wp-ajax-action")||i;delete e.ajaxAction;const r=o,u=e.postList?t(e.postList):t(l);delete e.postList;const f=e.hiddenField?t(e.hiddenField):t(s);delete e.hiddenField;const m=e.relevance||o.attr("data-wp-relevance")||d;function v(){const e=[];return u.children("li").each((function(){const n=t(this).attr("class").replace("widefat post-","");e.push(n)})),e}e=t.extend({position:{my:"left top+2",at:"left bottom",collision:"none"},source:function(e,o){a!==e.term?(t.ajax({type:"POST",dataType:"json",url:ajaxurl,data:{action:p,search_term:e.term,crp_get_posts_nonce:crp_metabox.nonce,postid:c,exclude_post_ids:v(),relevance:m}}).done((function(t){const e=t.map((function(t){return{label:t.title,id:t.id}}));n=e,o(e)})).fail((function(){})),a=e.term):o(n)},search:function(t,e){if(r.val().match(/^\d+$/)){if(r.val().length<2)return!1}else if(r.val().length<3)return!1},focus:function(t,e){t.preventDefault()},select:function(e,n){const a=n.item,o=t("<li>").addClass("widefat post-"+a.id),c=t("<button>").text("").addClass("ntdelbutton button-link").attr("type","button");o.append(c),o.append(" "),o.append(a.label),u.append(o);if(0===v().length)f.val(a.id);else{const t=f.val();""===t?f.val(a.id):f.val(t+","+a.id)}return r.val(""),e.preventDefault(),!1}},e),o.on("keydown",(function(e){e.keyCode===t.ui.keyCode.TAB&&t(this).autocomplete("instance").menu.active&&e.preventDefault()})).autocomplete(e),u.on("click",".ntdelbutton",(function(){const e=t(this).parent(),n=e.attr("class").match(/post-(\d+)/)[1];e.remove();const a=v(),o=a.indexOf(n);o>-1&&a.splice(o,1),f.val(a.join(","))}))},t("#crp-manual-related").crpAutocompletePosts()}));