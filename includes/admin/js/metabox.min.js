jQuery(document).ready((function(t){t.fn.crpAutocompletePosts=function(e){var n,o,a=t(this),i=t("#post_ID").val();const c="crp_get_posts_action",l="#crp-post-list",s="#crp-manual-related-csv",d=(e=e||{}).ajaxAction||a.attr("data-wp-ajax-action")||c;delete e.ajaxAction;const p=a,r=e.postList?t(e.postList):t(l);delete e.postList;const u=e.hiddenField?t(e.hiddenField):t(s);function f(){const e=[];return r.children("li").each((function(){const n=t(this).attr("class").replace("widefat post-","");e.push(n)})),e}delete e.hiddenField,e=t.extend({position:{my:"left top+2",at:"left bottom",collision:"none"},source:function(e,a){o!==e.term?(t.ajax({type:"POST",dataType:"json",url:ajaxurl,data:{action:d,search_term:e.term,crp_get_posts_nonce:crp_metabox.nonce,postid:i,exclude_post_ids:f()}}).done((function(t){const e=t.map((function(t){return{label:t.title,id:t.id}}));n=e,a(e)})).fail((function(){})),o=e.term):a(n)},search:function(t,e){if(p.val().match(/^\d+$/)){if(p.val().length<2)return!1}else if(p.val().length<3)return!1},focus:function(t,e){t.preventDefault()},select:function(e,n){const o=n.item,a=t("<li>").addClass("widefat post-"+o.id),i=t("<button>").text("").addClass("ntdelbutton button-link").attr("type","button");a.append(i),a.append(" "),a.append(o.label),r.append(a);if(0===f().length)u.val(o.id);else{const t=u.val();""===t?u.val(o.id):u.val(t+","+o.id)}return p.val(""),e.preventDefault(),!1}},e),a.on("keydown",(function(e){e.keyCode===t.ui.keyCode.TAB&&t(this).autocomplete("instance").menu.active&&e.preventDefault()})).autocomplete(e),r.on("click",".ntdelbutton",(function(){const e=t(this).parent(),n=e.attr("class").match(/post-(\d+)/)[1];e.remove();const o=f(),a=o.indexOf(n);a>-1&&o.splice(a,1),u.val(o.join(","))}))},t("#crp-manual-related").crpAutocompletePosts()}));