jQuery(document).ready((function(e){e(".insert-codemirror-media").on("click",(function(t){t.preventDefault();e(this);var i=e("#wp-content-editor-container .CodeMirror")[0].CodeMirror;var n=wp.media.frames.file_frame=wp.media({frame:"post",state:"insert",multiple:!0});n.on("insert",(function(){n.state().get("selection").map((function(t){var a=n.state().display(t).toJSON();e.when(function(t,i){var n,a,o=i.caption;return wp.media.view.settings.captions||delete i.caption,t=wp.media.string.props(t,i),n={id:i.id,post_content:i.description,post_excerpt:o},t.linkUrl&&(n.url=t.linkUrl),"image"===i.type?(a=wp.media.string.image(t),_.each({align:"align",size:"image-size",alt:"image_alt"},(function(e,i){t[i]&&(n[e]=t[i])}))):"video"===i.type?a=wp.media.string.video(t,i):"audio"===i.type?a=wp.media.string.audio(t,i):(a=wp.media.string.link(t),n.post_title=t.title),e.ajax({type:"POST",dataType:"json",url:ajaxurl,data:{action:"send-attachment-to-editor",nonce:wp.media.view.settings.nonce.sendToEditor,attachment:n,html:a,post_id:wp.media.view.settings.post.id},success:function(e){}})}(a,t.toJSON())).done((function(e){mediaHtml=e.data,function(e,t){if(e.getSelection().length>0)e.replaceSelection(t);else{var i=e.getDoc(),n=i.getCursor(),a={line:n.line,ch:n.ch};i.replaceRange(t,a)}}(i,mediaHtml)}))}))})),n.open()}))}));