!function(t){"use strict";t(document).ready(function(){document.querySelectorAll(".ts_autocomplete").forEach(function(e){const o=e.getAttribute("data-wp-prefix")||"WZ",a=window[`${o}TomSelectSettings`]||WZTomSelectSettings,n=e.getAttribute("data-wp-action")||a.action,r=e.getAttribute("data-wp-nonce")||a.nonce,i=e.getAttribute("data-wp-endpoint")||a.endpoint,s=a.forms,l=a.tags,c=a.custom_fields,u=a.strings,d="forms"===i?s:"tags"===i?l:"custom_fields"===i?c:[],p="category"===i||"post_tag"===i||i.includes("tax")||"public_taxonomies"===i;if(!d||!Array.isArray(d))return void console.error("Invalid options for endpoint:",i);const v=d.map(t=>({value:t.id,text:t.name})),m=e.value.split(",").map(t=>t.trim()).filter(Boolean);if(p&&m.length>0){const t=m.map(t=>{const e=t.match(/^(.*)\s+\(.*:\d+\)$/);return{value:t,text:e?e[1]:t}}),e=[...v];t.forEach(t=>{e.some(e=>e.value===t.value)||e.push(t)}),v.length=0,v.push(...e)}!p&&m.length>0&&m.forEach(t=>{v.some(e=>e.value===t)||v.push({value:t,text:t})});let f={};const g=e.getAttribute("data-ts-config");if(g)try{f=JSON.parse(g)}catch(t){console.error("Error parsing custom config:",g,t)}const h={...{plugins:["dropdown_input","clear_button","remove_button"],valueField:"value",labelField:"text",searchField:["text","value"],options:v,items:m,persist:!0,createOnBlur:!1,create:!1,render:{no_results:(t,e)=>`<div class="no-results">${u.no_results.replace("%s",e(t.input))}</div>`,option:(t,e)=>p||t.text===t.value?`<div>${e(t.value)}</div>`:`<div>${e(t.text)} (${e(t.value)})</div>`,item:(t,e)=>p||t.text===t.value?`<div>${e(t.value)}</div>`:`<div>${e(t.text)} (${e(t.value)})</div>`},load:function(e,o){e.length?t.ajax({url:ajaxurl,type:"POST",dataType:"json",data:{action:n,nonce:r,q:e,endpoint:i},error:function(){o()},success:function(t){t.success&&Array.isArray(t.data)?o(t.data):o()}}):o()}},...f};try{new TomSelect(e,h)}catch(t){console.error("Tom Select initialization error:",t)}})})}(jQuery);